import{_ as ee,C as ae,r as b,j as x,F as te,D as q,I as M,J as f,P as u,b0 as c,Q as n,K as F,L as k,b1 as m,S as I,O as R,b2 as O,au as U,aj as T,b3 as G,H as S}from"./index-D0h4CHmi.js";import{B as D,N as oe}from"./mapConfig-kUeC-l4-.js";import{N as H,a as y,b as se}from"./text-Cd5D-HXZ.js";import{a as le,N as J}from"./RadioGroup-ixV2IbpS.js";import"./get-slot-Bk_rJcZu.js";const ne={class:"map-selector"},re={class:"selector-group"},ie={key:0,class:"selector-group"},ce={key:1,class:"selector-group"},ue={key:2,class:"selector-group"},de={class:"checkbox-list"},ve={key:3,class:"selector-group"},pe={class:"checkbox-list"},fe={__name:"MapSelector",setup(me){const v=ae(),g=b("regions"),_=b(null),A=b(null),C=b([]),E=b([]),l=b([]),r=b(new Set),L=x(()=>l.value.length?l.value.every(a=>r.value.has(String(a.code))):!1),K=x(()=>C.value.map(a=>({label:a,value:a}))),Q=x(()=>E.value.map(a=>({label:a,value:a})));function Y(a){_.value=null,A.value=null,v.setMapLevel(a),v.setMapFocus(null),P()}function W(a){v.setMapFocus(a),P(),$()}function X(a){v.setMapFocus(a),P(),$()}function V(a){return r.value.has(String(a))}function j(a,e){const t=String(a);e?r.value.add(t):r.value.delete(t),v.setSelectedSubdivisions(Array.from(r.value))}function B(a){a?r.value=new Set(l.value.map(e=>String(e.code))):r.value=new Set,v.setSelectedSubdivisions(Array.from(r.value))}function P(){r.value.clear(),l.value=[],v.setSelectedSubdivisions([])}async function $(){const a="/philippine-map-data-visualizer/";if(g.value==="regions"&&_.value)if(_.value.includes(oe))try{const d=await(await fetch(`${a}${D.cities}`)).json(),h=S(_.value),w=(d.features||[]).filter(o=>{const i=o.properties||{};return S(i.ADM1_EN)===h}).map(o=>{const i=o.properties||{},s=S(i.ADM3_EN);return{code:String(i.ADM3_PCODE||s),name:s}}).filter(o=>o.name),N=new Map(w.map(o=>[o.code,o]));l.value=Array.from(N.values()).sort((o,i)=>o.name.localeCompare(i.name)),r.value=new Set(l.value.map(o=>String(o.code))),v.setSelectedSubdivisions(Array.from(r.value))}catch(t){console.warn("Failed to load ADM3 for NCR city/municipality subdivisions:",t),l.value=[]}else try{const d=await(await fetch(`${a}${D.provinces}`)).json(),h=S(_.value),w=(d.features||[]).filter(o=>{const i=o.properties||{};return S(i.ADM1_EN)===h}).map(o=>{const i=o.properties||{},s=S(i.ADM2_EN);return{code:String(i.ADM2_PCODE||s),name:s}}).filter(o=>o.name),N=new Map(w.map(o=>[o.code,o]));l.value=Array.from(N.values()).sort((o,i)=>o.name.localeCompare(i.name)),r.value=new Set(l.value.map(o=>String(o.code))),v.setSelectedSubdivisions(Array.from(r.value))}catch(t){console.warn("Failed to load ADM2 for region subdivisions:",t),l.value=[]}else if(g.value==="provinces"&&A.value)try{const t=await(await fetch(`${a}${D.provinces}`)).json(),d=S(A.value);let h=null;if((t.features||[]).some(s=>{const p=s.properties||{};return S(p.ADM2_EN)===d?(h=String(p.ADM2_PCODE||""),!0):!1}),!h){console.warn("Could not resolve ADM2_PCODE for province",A.value),l.value=[];return}const o=((await(await fetch(`${a}${D.cities}`)).json()).features||[]).filter(s=>{const p=s.properties||{};return String(p.ADM2_PCODE||"")===h}).map(s=>{const p=s.properties||{},z=S(p.ADM3_EN);return{code:String(p.ADM3_PCODE||z),name:z}}).filter(s=>s.name),i=new Map(o.map(s=>[s.code,s]));l.value=Array.from(i.values()).sort((s,p)=>s.name.localeCompare(p.name)),r.value=new Set(l.value.map(s=>String(s.code))),v.setSelectedSubdivisions(Array.from(r.value))}catch(e){console.warn("Failed to load ADM3 for province subdivisions:",e),l.value=[]}else l.value=[]}async function Z(){const a="/philippine-map-data-visualizer/";try{const t=await(await fetch(`${a}${D.provinces}`)).json(),d=new Set,h=new Set;(t.features||[]).forEach(w=>{const N=w.properties||{};N.ADM1_EN&&d.add(S(N.ADM1_EN)),N.ADM2_EN&&h.add(S(N.ADM2_EN))}),C.value=Array.from(d).sort(),E.value=Array.from(h).sort()}catch(e){console.warn("Failed to load ADM2 for selector lists:",e),C.value=[],E.value=[]}}return te(()=>{Z()}),q(()=>v.mapLevel,a=>{g.value=a}),q([g,_,A],()=>{P(),$()}),(a,e)=>(f(),M("div",ne,[u(n(se),{size:"small",title:"Map View"},{default:c(()=>[u(n(H),{vertical:""},{default:c(()=>[F("div",re,[u(n(y),{strong:""},{default:c(()=>[...e[3]||(e[3]=[m("View Level",-1)])]),_:1}),u(n(le),{value:g.value,"onUpdate:value":[e[0]||(e[0]=t=>g.value=t),Y]},{default:c(()=>[u(n(H),{vertical:""},{default:c(()=>[u(n(J),{value:"regions"},{default:c(()=>[...e[4]||(e[4]=[m(" Regions ",-1)])]),_:1}),u(n(J),{value:"provinces"},{default:c(()=>[...e[5]||(e[5]=[m(" Provinces ",-1)])]),_:1})]),_:1})]),_:1},8,["value"])]),g.value==="regions"&&C.value.length>0?(f(),M("div",ie,[u(n(y),{strong:""},{default:c(()=>[...e[6]||(e[6]=[m("Select Region",-1)])]),_:1}),u(n(I),{value:_.value,"onUpdate:value":[e[1]||(e[1]=t=>_.value=t),W],options:K.value,placeholder:"View all regions",clearable:"",filterable:""},null,8,["value","options"])])):k("",!0),g.value==="provinces"&&E.value.length>0?(f(),M("div",ce,[u(n(y),{strong:""},{default:c(()=>[...e[7]||(e[7]=[m("Select Province",-1)])]),_:1}),u(n(I),{value:A.value,"onUpdate:value":[e[2]||(e[2]=t=>A.value=t),X],options:Q.value,placeholder:"View all provinces",clearable:"",filterable:""},null,8,["value","options"])])):k("",!0),g.value==="regions"&&_.value?(f(),M("div",ue,[u(n(y),{strong:""},{default:c(()=>[m("Provinces in "+R(_.value),1)]),_:1}),F("div",de,[l.value.length>0?(f(),O(n(U),{key:0,checked:L.value,"onUpdate:checked":B},{default:c(()=>[...e[8]||(e[8]=[m(" Select all ",-1)])]),_:1},8,["checked"])):k("",!0),(f(!0),M(T,null,G(l.value,t=>(f(),O(n(U),{key:t.code,checked:V(t.code),"onUpdate:checked":d=>j(t.code,d)},{default:c(()=>[m(R(t.name),1)]),_:2},1032,["checked","onUpdate:checked"]))),128))])])):k("",!0),g.value==="provinces"&&A.value?(f(),M("div",ve,[u(n(y),{strong:""},{default:c(()=>[m("Cities/Municipalities in "+R(A.value),1)]),_:1}),F("div",pe,[l.value.length>0?(f(),O(n(U),{key:0,checked:L.value,"onUpdate:checked":B},{default:c(()=>[...e[9]||(e[9]=[m(" Select all ",-1)])]),_:1},8,["checked"])):k("",!0),(f(!0),M(T,null,G(l.value,t=>(f(),O(n(U),{key:t.code,checked:V(t.code),"onUpdate:checked":d=>j(t.code,d)},{default:c(()=>[m(R(t.name),1)]),_:2},1032,["checked","onUpdate:checked"]))),128))])])):k("",!0)]),_:1})]),_:1})]))}},be=ee(fe,[["__scopeId","data-v-7c63951d"]]);export{be as default};
